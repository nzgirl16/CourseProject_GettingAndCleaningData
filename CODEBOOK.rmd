---
title: "CODEBOOK"
date: "Created on 11/17/2020"
output: html_document
---

### DATA
*Below description is taken from the documentation of the dataset:*     
The experiments have been carried out with a group of 30 volunteers within an age bracket of 19-48 years. Each person performed six activities (WALKING, WALKING_UPSTAIRS, WALKING_DOWNSTAIRS, SITTING, STANDING, LAYING) wearing a smartphone (Samsung Galaxy S II) on the waist. Using its embedded accelerometer and gyroscope, we captured 3-axial linear acceleration and 3-axial angular velocity at a constant rate of 50Hz. The experiments have been video-recorded to label the data manually. The obtained dataset has been randomly partitioned into two sets, where 70% of the volunteers was selected for generating the training data and 30% the test data.     

The sensor signals (accelerometer and gyroscope) were pre-processed by applying noise filters and then sampled in fixed-width sliding windows of 2.56 sec and 50% overlap (128 readings/window). The sensor acceleration signal, which has gravitational and body motion components, was separated using a Butterworth low-pass filter into body acceleration and gravity. The gravitational force is assumed to have only low frequency components, therefore a filter with 0.3 Hz cutoff frequency was used. From each window, a vector of features was obtained by calculating variables from the time and frequency domain. See 'features_info.txt' for more details.     

For each record it is provided:   
- An identifier of the subject who carried out the experiment.     
- Its activity label.     
- A 561-feature vector with time and frequency domain variables.     


### PROCESS
1. Download the data and extract it.     

```{r eval=FALSE}
url <- "https://d396qusza40orc.cloudfront.net/getdata%2Fprojectfiles%2FUCI%20HAR%20Dataset.zip"
download.file(url, destfile="data.zip")
unzip("data.zip")
list.files(recursive=TRUE)
```

2. Import the **activity_labels.txt** onto the *activityLabels* data frame. Then, rename the column names to *ActivityCode* and *Activity*.     

```{r eval=FALSE}
activityLabels <- read.table("UCI HAR Dataset/activity_labels.txt")
colnames(activityLabels) <- c("ActivityCode", "Activity")
```

3. Convert the first column of activityLabels to a numeric data type.

```{r eval=FALSE}
activityLabels[,1] <- as.numeric(activityLabels[,1])
```

4. Import the **features.txt** onto the *features* data frame. Then, rename the column names to *FeaturesCode* and *Features*.

```{r eval=FALSE}
features <- read.table("UCI HAR Dataset/features.txt")
colnames(features) <- c("FeaturesCode", "Features")
```

5. Consolidate the **subject_test.txt**, **X_test.txt**, and **y_test.txt** onto the *test_data* data frame. Note to consolidate in the order of the files specified.     

```{r eval=FALSE}
test_files <- list.files("UCI HAR Dataset/test", full.names=TRUE)
test_files <- test_files[!grepl("Inertial Signals", test_files)]
test_data <- read.table(test_files[1])
for (i in 2:length(test_files)) {
    test_data <- cbind(test_data, read.table(test_files[i]))
}
```

6. Do the same for the train data sets. Place the data onto the *train_data* data frame.     

```{r eval=FALSE}
train_files <- list.files("UCI HAR Dataset/train", full.names=TRUE)
train_files <- train_files[!grepl("Inertial Signals", train_files)]
train_data <- read.table(train_files[1])
for (i in 2:length(train_files)) {
    train_data <- cbind(train_data, read.table(train_files[i]))
}
```

7. Append the *train_data* onto the *test_data* and store it onto the *combined_data* data frame.     

```{r eval=FALSE}
combined_data <- rbind(test_data, train_data)
```

8. Assign the following column names:     
    + Column 1: *"Subject ID"*     
    + Columns 2-562: Use the second column of *features*     
    + Column 3: *"Activity Performed"*     

```{r eval=FALSE}
colnames(combined_data) <- c("Subject ID", features[,2], "Activity Performed")
```

9. Add an additional column to *combined_data* named *Activity* wherein it's the actual activity performed based from *activityLabels*.     

```{r eval=FALSE}
final_data <- merge(combined_data, activityLabels, by.x="Activity Performed", by.y="ActivityCode")
```

10. Delete the *Activity Performed* column. Then, reorder the columns in *combined_data* such that *Subject ID* is the first column and *Activity* is the second column.     

```{r eval=FALSE}
final_data <- final_data[c(2, 564, 3:563)]
```
   
11. Extract the measurements on the mean and store it onto the *mean_data* data frame.     

```{r eval=FALSE}
mean_data <- final_data[,grepl("[Mm]ean", colnames(final_data))]
```

12. Do the same for measurements on the standard deviation. Store it onto the *stdev_data* data frame.     

```{r eval=FALSE}
stdev_data <- final_data[,grepl("std", colnames(final_data))]
```

13. Create another data frame *groupedmean_data* wherein it provides the average per *Subject ID* and *Activity* for each variable/column. 

```{r eval=FALSE}
groupedmean_data <- aggregate(final_data, list(final_data[,1], final_data[,2]), mean, na.rm=TRUE, simplify=TRUE)
groupedmean_data <- groupedmean_data[-c(3,4)]
colnames(groupedmean_data)[1] <- "Subject ID"
colnames(groupedmean_data)[2] <- "Activity"

```

14. Create a text file **output.txt** containing *groupedmean_data*.     

```{r eval=FALSE}
write.table(groupedmean_data, "output.txt")
```